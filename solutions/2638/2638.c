n,m,a[102][102],i,j,c,h,t;f(x,y){t=(a[x-1][y]==2)+(a[x+1][y]==2)+(a[x][y-1]==2)+(a[x][y+1]==2);if(t==0)return;a[x][y]=2;if(x!=1&&a[x-1][y]==0){f(x-1,y);}if(x!=n&&a[x+1][y]==0){f(x+1,y);}if(y!=1&&a[x][y-1]==0){f(x,y-1);}if(y!=n&&a[x][y+1]==0){f(x,y+1);}}main(){scanf("%d%d",&n,&m);for(i=1;i<=n;i++){for(j=1;j<=m;j++){scanf("%d",&a[i][j]);}}a[1][1]=2;for(c=1;c;h++){for(i=1;i<=n;i++){for(j=1;j<=m;j++){if(a[i][j]==0){f(i,j);}}}c=0;for(i=1;i<=n;i++){for(j=1;j<=m;j++){if(a[i][j]!=1)continue;c=1;t=(a[i-1][j]==2)+(a[i+1][j]==2)+(a[i][j-1]==2)+(a[i][j+1]==2);if(t>=2){a[i][j]=0;}}}}printf("%d",h-1);}